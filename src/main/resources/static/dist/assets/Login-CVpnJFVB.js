import{R as y,r as c,j as t,b}from"./mui-Czmlt3Wi.js";import{A as S}from"./api-C-m1HPol.js";import{u as C,L as $}from"./index-D5ySl4-Q.js";import"./vendor-DJG_os-6.js";const g=r=>r.replace(/[^\d]/g,""),v=r=>{const i=g(r);if(i.length!==14||/^(\d)\1+$/.test(i))return!1;let a=0,o=5;for(let n=0;n<12;n++)a+=parseInt(i[n])*o,o=o===2?9:o-1;let l=a%11<2?0:11-a%11;a=0,o=6;for(let n=0;n<13;n++)a+=parseInt(i[n])*o,o=o===2?9:o-1;let m=a%11<2?0:11-a%11;return l===parseInt(i[12])&&m===parseInt(i[13])},E=y.memo(({value:r,onChange:i,error:a,helperText:o,...l})=>{const[m,n]=c.useState(!1),[p,u]=c.useState(""),h=s=>{const e=g(s);return e.length<=2?e:e.length<=5?`${e.slice(0,2)}.${e.slice(2)}`:e.length<=8?`${e.slice(0,2)}.${e.slice(2,5)}.${e.slice(5)}`:e.length<=12?`${e.slice(0,2)}.${e.slice(2,5)}.${e.slice(5,8)}/${e.slice(8)}`:`${e.slice(0,2)}.${e.slice(2,5)}.${e.slice(5,8)}/${e.slice(8,12)}-${e.slice(12,14)}`};c.useEffect(()=>{if(r&&g(r).length===14){const s=v(r);n(!s),u(s?"":"CNPJ inv√°lido")}else r&&g(r).length>0,n(!1),u("")},[r]);const d=s=>{const e=s.target.value;if(g(e).length<=14){const x=h(e),j={...s,target:{...s.target,value:x}};i(j)}};return t.jsx(b,{...l,value:r,onChange:d,error:a||m,helperText:o||p,label:"CNPJ",placeholder:"00.000.000/0000-00",fullWidth:!0,variant:"outlined",inputProps:{maxLength:18}})}),T=()=>{const[r,i]=c.useState(""),[a,o]=c.useState(""),[l,m]=c.useState(!1),[n,p]=c.useState(""),u=C(),h=async d=>{d.preventDefault(),m(!0),p("");try{const s=await fetch(`${S}/api/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cnpj:g(r),senha:a})});if(!s.ok)throw new Error(`Erro: ${s.status}`);const e=await s.json();if(e.success===!0||e.data&&e.data.token){const f=e.data||e;localStorage.setItem("token",f.token),localStorage.setItem("empresa",JSON.stringify(f)),u("/dashboard")}else p(e.message||"Erro no login")}catch{p("Erro de conex√£o com o servidor")}finally{m(!1)}};return t.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",backgroundColor:"#f5f5f5"},children:t.jsxs("div",{style:{backgroundColor:"white",padding:"2rem",borderRadius:"8px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",width:"100%",maxWidth:"400px"},children:[t.jsx("h2",{style:{textAlign:"center",marginBottom:"2rem"},children:"Sistema de Valida√ß√£o de Documentos"}),t.jsxs("form",{onSubmit:h,children:[t.jsx("div",{style:{marginBottom:"1rem"},children:t.jsx(E,{value:r,onChange:d=>i(d.target.value),variant:"outlined",size:"medium",required:!0})}),t.jsxs("div",{style:{marginBottom:"1.5rem"},children:[t.jsx("label",{style:{display:"block",marginBottom:"0.5rem"},children:"Senha:"}),t.jsx("input",{type:"password",value:a,onChange:d=>o(d.target.value),placeholder:"Digite sua senha",required:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #ddd",borderRadius:"4px",fontSize:"1rem"}})]}),n&&t.jsx("div",{style:{color:"red",marginBottom:"1rem",textAlign:"center"},children:n}),t.jsx("button",{type:"submit",disabled:l,style:{width:"100%",padding:"0.75rem",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",fontSize:"1rem",cursor:l?"not-allowed":"pointer",opacity:l?.6:1},children:l?"Entrando...":"Entrar"})]}),t.jsxs("div",{style:{textAlign:"center",marginTop:"1.5rem",marginBottom:"1rem"},children:[t.jsx("p",{style:{color:"#666",fontSize:"0.9rem",marginBottom:"0.5rem"},children:"N√£o tem uma conta?"}),t.jsx($,{to:"/cadastro",style:{color:"#1976d2",textDecoration:"none",fontWeight:"bold",fontSize:"1rem"},children:"üìù Cadastrar Nova Empresa"})]})]})})};export{T as default};
