import{r as n,j as e,d as g,A as l,P as E,f as c,B as q,G as o,b as i,y as S,z as b,h as A,x as B}from"./mui-Czmlt3Wi.js";import{a as I}from"./index-xsH4HHeE.js";import{A as T}from"./api-C-m1HPol.js";import"./vendor-DJG_os-6.js";function w(){const[a,d]=n.useState({titulo:"",descricao:"",nomeMotorista:"",arquivo:null}),[u,m]=n.useState(""),[p,x]=n.useState(""),[h,j]=n.useState(!1),f=localStorage.getItem("empresaId");if(localStorage.getItem("empresaTipo")!=="DESPACHANTE")return e.jsx(g,{maxWidth:"md",sx:{mt:4},children:e.jsx(l,{severity:"error",children:"Apenas despachantes podem enviar documentos."})});const s=r=>{const{name:t,value:v}=r.target;d(D=>({...D,[t]:v}))},y=r=>{d(t=>({...t,arquivo:r.target.files[0]}))},C=async r=>{r.preventDefault(),j(!0),x(""),m("");try{const t=new FormData;t.append("arquivo",a.arquivo),t.append("titulo",a.titulo),t.append("descricao",a.descricao),t.append("nomeMotorista",a.nomeMotorista),t.append("empresaId",f);const v=await I.post(`${T}/documentos/enviar`,t,{headers:{"Content-Type":"multipart/form-data"}});m("Documento enviado com sucesso! A Estrada Fácil foi notificada por email."),d({titulo:"",descricao:"",nomeMotorista:"",arquivo:null}),document.getElementById("arquivo-input").value=""}catch(t){x(t.response?.data||"Erro ao enviar documento")}finally{j(!1)}};return e.jsx(g,{maxWidth:"md",sx:{mt:4},children:e.jsxs(E,{sx:{p:4},children:[e.jsx(c,{variant:"h4",gutterBottom:!0,align:"center",children:"Enviar Documento para Validação"}),u&&e.jsx(l,{severity:"success",sx:{mb:3},children:u}),p&&e.jsx(l,{severity:"error",sx:{mb:3},children:p}),e.jsx(q,{component:"form",onSubmit:C,children:e.jsxs(o,{container:!0,spacing:3,children:[e.jsx(o,{item:!0,xs:12,children:e.jsx(i,{fullWidth:!0,label:"Título do Documento",name:"titulo",value:a.titulo,onChange:s,required:!0})}),e.jsx(o,{item:!0,xs:12,children:e.jsx(i,{fullWidth:!0,label:"Descrição",name:"descricao",value:a.descricao,onChange:s,multiline:!0,rows:3})}),e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Nome do Motorista",name:"nomeMotorista",value:a.nomeMotorista,onChange:s,required:!0})}),e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,onChange:s,required:!0,placeholder:"000.000.000-00"})}),e.jsx(o,{item:!0,xs:12,children:e.jsx(S,{variant:"outlined",children:e.jsxs(b,{children:[e.jsx(c,{variant:"h6",gutterBottom:!0,children:"Arquivo do Documento"}),e.jsx("input",{id:"arquivo-input",type:"file",onChange:y,required:!0,accept:".pdf,.jpg,.jpeg,.png,.doc,.docx",style:{marginBottom:"10px"}}),e.jsx(c,{variant:"caption",display:"block",color:"text.secondary",children:"Formatos aceitos: PDF, JPG, PNG, DOC, DOCX (máx. 10MB)"})]})})}),e.jsx(o,{item:!0,xs:12,children:e.jsx(A,{type:"submit",fullWidth:!0,variant:"contained",size:"large",disabled:h,startIcon:e.jsx(B,{}),sx:{py:2},children:h?"Enviando...":"Enviar Documento"})})]})})]})})}export{w as default};
